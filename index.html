<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SROI Calculator - ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            /* Bangkok University Colors */
            --color-primary: #1e3a8a;
            --color-primary-light: #3b82f6;
            --color-secondary: #f59e0b;
            --color-success: #10b981;
            --color-danger: #ef4444;
            --color-warning: #f59e0b;
            --color-info: #3b82f6;
            --color-light: #f8fafc;
            --color-dark: #1e293b;
            --color-border: #e2e8f0;
            --color-text: #334155;
            --color-text-light: #64748b;
            
            /* Spacing */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Border radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: var(--color-text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-md);
        }

        .header {
            background: var(--color-primary);
            color: white;
            padding: var(--space-lg) 0;
            box-shadow: var(--shadow-lg);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-md);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: var(--space-xs);
        }

        .header .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .developer-credit {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            border: none;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s ease;
            font-family: 'Sarabun', sans-serif;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--color-primary-light);
        }

        .btn-secondary {
            background: var(--color-light);
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .btn-danger {
            background: var(--color-danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-success {
            background: var(--color-success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-md);
        }

        .login-card {
            background: white;
            padding: var(--space-2xl);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 450px;
            text-align: center;
        }

        .login-card h2 {
            color: var(--color-primary);
            margin-bottom: var(--space-lg);
            font-size: 1.8rem;
            font-weight: 600;
            font-family: 'Sarabun', sans-serif;
        }

        .form-group {
            margin-bottom: var(--space-md);
            text-align: left;
        }

        .form-label {
            display: block;
            margin-bottom: var(--space-sm);
            font-weight: 500;
            color: var(--color-text);
            font-family: 'Sarabun', sans-serif;
        }

        .form-control {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            transition: border-color 0.2s ease;
            font-family: 'Sarabun', sans-serif;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }

        .form-link {
            text-align: center;
            margin-top: var(--space-md);
            color: var(--color-text-light);
            font-size: 0.9rem;
            font-family: 'Sarabun', sans-serif;
        }

        .form-link a {
            color: var(--color-primary);
            text-decoration: none;
            font-weight: 500;
            font-family: 'Sarabun', sans-serif;
        }

        .form-link a:hover {
            text-decoration: underline;
        }

        .divider {
            display: flex;
            align-items: center;
            margin: var(--space-lg) 0;
            color: var(--color-text-light);
            font-size: 0.9rem;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid var(--color-border);
        }

        .divider span {
            padding: 0 var(--space-md);
        }

        .google-btn {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--color-border);
            background: white;
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            font-family: 'Sarabun', sans-serif;
        }

        .google-btn:hover {
            background: var(--color-light);
        }

        .google-btn img {
            width: 20px;
            height: 20px;
        }
<!-- Dashboard Section -->
<div id="dashboardSection" class="dashboard-section" style="display: none;">
    <div class="container">
        <!-- Header -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
            <div>
                <h2 style="color: var(--color-primary); margin: 0 0 8px 0;">üìä Dashboard - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h2>
                <p style="color: #64748b; margin: 0;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ SROI ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
            </div>
            <button type="button" class="btn btn-primary" onclick="createNewProject()">
                ‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
            </button>
        </div>

        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="stat-icon">üìÅ</div>
                <div class="stat-info">
                    <div class="stat-label">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    <div class="stat-value" id="totalProjects">0</div>
                </div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-info">
                    <div class="stat-label">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                    <div class="stat-value" id="inProgressProjects">0</div>
                </div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <div class="stat-label">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</div>
                    <div class="stat-value" id="completedProjects">0</div>
                </div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                <div class="stat-icon">üí∞</div>
                <div class="stat-info">
                    <div class="stat-label">SROI ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                    <div class="stat-value" id="avgSROI">0.00</div>
                </div>
            </div>
        </div>

        <!-- Filters -->
        <div class="card" style="margin-top: 32px;">
            <div style="display: flex; gap: 16px; align-items: center; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <input type="text" id="searchProject" class="form-control" 
                           placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£..." 
                           onkeyup="filterProjects()">
                </div>
                <select id="filterStatus" class="form-control" style="width: auto;" onchange="filterProjects()">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                    <option value="draft">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                    <option value="completed">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</option>
                </select>
            </div>
        </div>

        <!-- Projects Table -->
        <div class="card" style="margin-top: 24px;">
            <div style="overflow-x: auto;">
                <table class="projects-table">
                    <thead>
                        <tr>
                            <th>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</th>
                            <th>SROI Ratio</th>
                            <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="projectsTableBody">
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 60px; color: #94a3b8;">
                                <div style="font-size: 3rem; margin-bottom: 16px;">üì≠</div>
                                <div style="font-size: 1.2rem; margin-bottom: 8px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</div>
                                <div style="font-size: 0.95rem;">‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Dashboard -->
<style>
.dashboard-section {
    min-height: 100vh;
    padding: 40px 0;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 20px;
    margin-bottom: 32px;
}

.stat-card {
    padding: 24px;
    border-radius: 12px;
    color: white;
    display: flex;
    align-items: center;
    gap: 16px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.stat-icon {
    font-size: 2.5rem;
}

.stat-info {
    flex: 1;
}

.stat-label {
    font-size: 0.9rem;
    opacity: 0.9;
    margin-bottom: 4px;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
}

.projects-table {
    width: 100%;
    border-collapse: collapse;
}

.projects-table thead {
    background: #f1f5f9;
}

.projects-table th {
    padding: 16px;
    text-align: left;
    font-weight: 600;
    color: #334155;
    border-bottom: 2px solid #cbd5e1;
    white-space: nowrap;
}

.projects-table td {
    padding: 16px;
    border-bottom: 1px solid #e2e8f0;
}

.projects-table tbody tr:hover {
    background: #f8fafc;
}

.status-badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.85rem;
    font-weight: 500;
}

.status-draft {
    background: #fef3c7;
    color: #92400e;
}

.status-completed {
    background: #d1fae5;
    color: #065f46;
}

.action-buttons {
    display: flex;
    gap: 8px;
}

.btn-icon {
    padding: 8px 12px;
    font-size: 0.9rem;
    min-width: auto;
}

@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .projects-table {
        font-size: 0.85rem;
    }
    
    .projects-table th,
    .projects-table td {
        padding: 12px 8px;
    }
}
</style>
        #mainApp {
            display: none;
        }

        .main-content {
            margin-top: var(--space-xl);
            padding-bottom: var(--space-2xl);
        }

        .card {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            box-shadow: var(--shadow-md);
            margin-bottom: var(--space-lg);
        }

        .steps-nav {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--space-2xl);
            flex-wrap: wrap;
            gap: var(--space-sm);
        }

        .step {
            flex: 1;
            min-width: 120px;
            padding: var(--space-sm);
            text-align: center;
            background: var(--color-light);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Sarabun', sans-serif;
        }

        .step:hover {
            background: #e2e8f0;
        }

        .step.active {

    /* Step ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß - ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
.step.completed {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    position: relative;
}

.step.completed:hover {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
}

/* ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏π‡∏Å ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö step ‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à */
.step.completed::after {
    content: '‚úì';
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 1rem;
    font-weight: bold;
    color: white;
    background: rgba(255, 255, 255, 0.2);
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Step ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥ - ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô */
.step.active {
    background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
    color: white;
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
}

/* Step ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥ - ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤ */
.step:not(.active):not(.completed) {
    background: var(--color-light);
    color: var(--color-text-light);
}
            background: var(--color-primary);
            color: white;
        }

        .step-number {
            display: block;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: var(--space-xs);
        }

        .step-name {
            font-size: 0.85rem;
            font-family: 'Sarabun', sans-serif;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
        }

        .step-header {
            margin-bottom: var(--space-xl);
        }

        .step-title {
            color: var(--color-primary);
            font-size: 1.8rem;
            margin-bottom: var(--space-sm);
            font-family: 'Sarabun', sans-serif;
        }

        .step-description {
            color: var(--color-text-light);
            font-size: 1rem;
            font-family: 'Sarabun', sans-serif;
        }

        .section {
            margin-bottom: var(--space-xl);
        }

        .section-title {
            font-size: 1.3rem;
            color: var(--color-primary);
            margin-bottom: var(--space-md);
            font-family: 'Sarabun', sans-serif;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .table-container {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--space-md);
        }

        .table th,
        .table td {
            padding: var(--space-sm) var(--space-md);
            text-align: left;
            border-bottom: 1px solid var(--color-border);
            font-family: 'Sarabun', sans-serif;
        }

        .table th {
            background: var(--color-light);
            font-weight: 600;
            color: var(--color-primary);
        }

        .table tbody tr:hover {
            background: var(--color-light);
        }

        .action-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: var(--space-2xl);
            padding-top: var(--space-xl);
            border-top: 1px solid var(--color-border);
        }

        .chart-container {
            background: white;
            padding: var(--space-lg);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            margin-bottom: var(--space-lg);
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: var(--space-md);
            font-family: 'Sarabun', sans-serif;
        }

        .chart-canvas {
            position: relative;
            height: 300px;
        }

        .alert {
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
            font-family: 'Sarabun', sans-serif;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
/* Modal Overlay */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
}

.modal.show {
    display: flex !important;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease;
}

/* Modal Content */
.modal-content {
    background-color: white;
    margin: auto;
    padding: 0;
    border-radius: 12px;
    width: 90%;
    max-width: 600px;
    max-height: 90vh;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: slideDown 0.3s ease;
    overflow: hidden;
}

/* Modal Header */
.modal-header {
    padding: 24px 28px;
    background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
    color: white;
    border-radius: 12px 12px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h2 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    font-family: 'Sarabun', sans-serif;
}

.close-modal {
    color: white;
    font-size: 32px;
    font-weight: bold;
    cursor: pointer;
    background: none;
    border: none;
    padding: 0;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.2s;
    line-height: 1;
}

.close-modal:hover,
.close-modal:focus {
    background: rgba(255, 255, 255, 0.2);
    outline: none;
}

/* Modal Body */
.modal-body {
    padding: 28px;
    max-height: calc(90vh - 180px);
    overflow-y: auto;
}

.modal-form-group {
    margin-bottom: 20px;
}

.modal-form-group:last-child {
    margin-bottom: 0;
}

.modal-form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #334155;
    font-size: 0.95rem;
    font-family: 'Sarabun', sans-serif;
}

.modal-form-group input,
.modal-form-group select,
.modal-form-group textarea {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 1rem;
    font-family: 'Sarabun', sans-serif;
    transition: border-color 0.2s, box-shadow 0.2s;
    background: white;
}

.modal-form-group input:focus,
.modal-form-group select:focus,
.modal-form-group textarea:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.modal-form-group input::placeholder,
.modal-form-group textarea::placeholder {
    color: #94a3b8;
}

.modal-form-group textarea {
    resize: vertical;
    min-height: 80px;
    max-height: 200px;
}

.modal-form-group small {
    display: block;
    margin-top: 6px;
    color: #64748b;
    font-size: 0.85rem;
    font-family: 'Sarabun', sans-serif;
}

/* Modal Footer */
.modal-footer {
    padding: 20px 28px;
    background: #f8fafc;
    border-radius: 0 0 12px 12px;
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    border-top: 1px solid #e2e8f0;
}

.modal-footer .btn {
    min-width: 120px;
    font-size: 1rem;
}

/* Animations */
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes slideDown {
    from {
        transform: translateY(-50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* Responsive */
@media (max-width: 768px) {
    .modal-content {
        width: 95%;
        margin: 10px;
        max-height: 95vh;
    }
    
    .modal-header {
        padding: 20px;
    }
    
    .modal-header h2 {
        font-size: 1.3rem;
    }
    
    .modal-body {
        padding: 20px;
        max-height: calc(95vh - 160px);
    }
    
    .modal-footer {
        padding: 16px 20px;
        flex-direction: column;
    }
    
    .modal-footer .btn {
        width: 100%;
    }
}

        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.2rem;
            }

            .steps-nav {
                flex-direction: column;
            }

            .step {
                min-width: 100%;
            }

            .input-group {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
                gap: var(--space-md);
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Authentication Screen -->
    <div id="authScreen" class="login-container">
        <div class="login-card">
            <!-- Login Form -->
            <div id="loginForm">
                <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
                <p class="step-description" style="margin-bottom: var(--space-lg);">SROI Calculator - ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</p>
                
                <div id="loginAlert"></div>
                
                <form onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label class="form-label" for="loginEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                        <input type="email" class="form-control" id="loginEmail" placeholder="your@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="loginPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                        <input type="password" class="form-control" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: var(--space-md);">
                        ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                </form>
                
                <div class="divider">
                    <span>‡∏´‡∏£‡∏∑‡∏≠</span>
                </div>
                
                <button type="button" class="google-btn" onclick="handleGoogleSignIn()">
                    <svg width="20" height="20" viewBox="0 0 48 48">
                        <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
                        <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
                        <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
                        <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                    </svg>
                    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Google
                </button>
                
                <div class="form-link">
                    ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ? <a href="javascript:void(0)" onclick="toggleForm()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
                </div>
            </div>

            <!-- Register Form -->
            <div id="registerForm" style="display: none;">
                <h2>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
                <p class="step-description" style="margin-bottom: var(--space-lg);">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô SROI Calculator</p>
                
                <div id="registerAlert"></div>
                
                <form onsubmit="handleRegister(event)">
                    <div class="form-group">
                        <label class="form-label" for="registerName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                        <input type="text" class="form-control" id="registerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="registerEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                        <input type="email" class="form-control" id="registerEmail" placeholder="your@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="registerOrganization">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                        <input type="text" class="form-control" id="registerOrganization" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô">
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: var(--space-md);">
                        ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                    </button>
                </form>
                
                <div class="form-link">
                    ‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß? <a href="javascript:void(0)" onclick="toggleForm()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp">
        <div class="header">
            <div class="container">
                <div class="header-content">
                    <div>
                        <h1>SROI Calculator</h1>
                        <p class="subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</p>
                    </div>
                    <div>
                        <span id="userNameDisplay" style="margin-right: var(--space-md);"></span>
                        <button class="btn btn-secondary" onclick="handleLogout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
<!-- Profile Section -->
<div id="profileSection" class="profile-section" style="display: none;">
    <div class="container">
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h2 style="color: var(--color-primary); margin: 0;">üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h2>
                <button type="button" class="btn btn-secondary" onclick="closeProfile()">
                    ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </button>
            </div>
            
            <form id="profileForm" onsubmit="saveProfile(event)">
                <div class="row">
                    <!-- ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="profileName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span style="color: red;">*</span></label>
                            <input type="text" id="profileName" class="form-control" required 
                                   placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ">
                        </div>
                    </div>

                    <!-- ‡∏≠‡∏µ‡πÄ‡∏°‡∏• -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="profileEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏• <span style="color: red;">*</span></label>
                            <input type="email" id="profileEmail" class="form-control" required readonly
                                   style="background: #f1f5f9;"
                                   placeholder="email@example.com">
                            <small style="color: #64748b;">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)</small>
                        </div>
                    </div>

                    <!-- ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="profileOrganization">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ <span style="color: red;">*</span></label>
                            <input type="text" id="profileOrganization" class="form-control" required
                                   placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û">
                        </div>
                    </div>

                    <!-- ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="profilePosition">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á <span style="color: red;">*</span></label>
                            <input type="text" id="profilePosition" class="form-control" required
                                   placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£, ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå, ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£">
                        </div>
                    </div>

                    <!-- ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="profilePhone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <span style="color: red;">*</span></label>
                            <input type="tel" id="profilePhone" class="form-control" required
                                   placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-234-5678"
                                   pattern="[0-9]{3}-?[0-9]{3}-?[0-9]{4}">
                            <small style="color: #64748b;">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: 081-234-5678</small>
                        </div>
                    </div>

                    <!-- ‡πÅ‡∏ú‡∏ô‡∏Å/‡∏ù‡πà‡∏≤‡∏¢ -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="profileDepartment">‡πÅ‡∏ú‡∏ô‡∏Å/‡∏ù‡πà‡∏≤‡∏¢</label>
                            <input type="text" id="profileDepartment" class="form-control"
                                   placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ù‡πà‡∏≤‡∏¢‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ä‡∏∏‡∏°‡∏ä‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)">
                        </div>
                    </div>

                    <!-- ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ -->
                    <div class="col-12">
                        <div class="form-group">
                            <label for="profileAddress">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</label>
                            <textarea id="profileAddress" class="form-control" rows="3"
                                      placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Alert -->
                <div id="profileAlert"></div>

                <!-- Buttons -->
                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button type="submit" class="btn btn-primary">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeProfile()">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Profile -->
<style>
.profile-section {
    min-height: 100vh;
    padding: 40px 0;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
}

.row {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin: 0 -10px;
}

.col-12 {
    flex: 0 0 100%;
    padding: 0 10px;
}

.col-md-6 {
    flex: 0 0 calc(50% - 10px);
    padding: 0 10px;
}

@media (max-width: 768px) {
    .col-md-6 {
        flex: 0 0 100%;
    }
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #334155;
    font-size: 0.95rem;
}

.form-control {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 1rem;
    font-family: 'Sarabun', sans-serif;
    transition: border-color 0.2s;
}

.form-control:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.form-control::placeholder {
    color: #94a3b8;
}

textarea.form-control {
    resize: vertical;
    min-height: 80px;
}

.form-control small {
    display: block;
    margin-top: 4px;
    color: #64748b;
    font-size: 0.85rem;
}
</style>
            
            <div class="main-content">
                <div class="card">
                    <div class="steps-nav">
                        <div class="step active" onclick="goToStep(1)">
                            <span class="step-number">1</span>
                            <span class="step-name">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</span>
                        </div>
                        <div class="step" onclick="goToStep(2)">
                            <span class="step-number">2</span>
                            <span class="step-name">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</span>
                        </div>
                        <div class="step" onclick="goToStep(3)">
                            <span class="step-number">3</span>
                            <span class="step-name">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</span>
                        </div>
                        <div class="step" onclick="goToStep(4)">
                            <span class="step-number">4</span>
                            <span class="step-name">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤</span>
                        </div>
                        <div class="step" onclick="goToStep(5)">
                            <span class="step-number">5</span>
                            <span class="step-name">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</span>
                        </div>
                        <div class="step" onclick="goToStep(6)">
                            <span class="step-number">6</span>
                            <span class="step-name">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
                        </div>
                    </div>

                    <div class="steps-container">
                        <!-- Step 1: Project Information -->
                        <div id="step1" class="step-content active">
                            <div class="step-header">
                                <h2 class="step-title">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h2>
                                <p class="step-description">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</p>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</h3>
                                <div class="input-group">
                                    <div class="form-group">
                                        <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                                        <input type="text" class="form-control" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ (‡∏õ‡∏µ)</label>
                                        <input type="number" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ö‡∏≤‡∏ó)</label>
                                        <input type="number" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1000000">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</label>
                                        <input type="text" class="form-control" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h3>
                                <div class="form-group">
                                    <label class="form-label">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                                    <textarea class="form-control" rows="4" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
                                    <textarea class="form-control" rows="3" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Stakeholders -->
                        <div id="step2" class="step-content">
                            <div class="step-header">
                                <h2 class="step-title">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</h2>
                                <p class="step-description">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</p>
                            </div>
                            
                            <div class="section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                                    <h3 class="section-title" style="margin-bottom: 0;">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</h3>
                                    <button type="button" class="btn btn-primary" onclick="addStakeholder()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°</th>
                                                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô</th>
                                                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                                <th>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</th>
                                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                            </tr>
                                        </thead>
                                        <tbody id="stakeholderTableBody">
                                            <tr>
                                                <td colspan="5" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Outcomes -->
                        <div id="step3" class="step-content">
                            <div class="step-header">
                                <h2 class="step-title">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h2>
                                <p class="step-description">‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</p>
                            </div>
                            
                            <div class="section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                                    <h3 class="section-title" style="margin-bottom: 0;">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô</h3>
                                    <button type="button" class="btn btn-primary" onclick="addOutcome()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</button>
                                </div>
                                
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</th>
                                                <th>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</th>
                                                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                                <th>‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î</th>
                                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                            </tr>
                                        </thead>
                                        <tbody id="outcomeTableBody">
                                            <tr>
                                                <td colspan="5" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4: Valuation -->
                        <div id="step4" class="step-content">
                            <div class="step-header">
                                <h2 class="step-title">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h2>
                                <p class="step-description">‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠</p>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤</h3>
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</th>
                                                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                                <th>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó)</th>
                                                <th>Deadweight (%)</th>
                                                <th>Attribution (%)</th>
                                                <th>Displacement (%)</th>
                                                <th>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏õ‡∏µ)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="valuationTableBody">
                                            <tr>
                                                <td colspan="7" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤</h3>
                                <ul style="line-height: 2;">
                                    <li><strong>Deadweight:</strong> ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</li>
                                    <li><strong>Attribution:</strong> ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°</li>
                                    <li><strong>Displacement:</strong> ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Step 5: Results -->
                        <div id="step5" class="step-content">
    <h2>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SROI</h2>
    <p style="color: #64748b; margin-bottom: 32px;">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏≤‡πà‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°</p>

    <!-- Investment Input -->
    <div style="background: #f1f5f9; padding: 24px; border-radius: 12px; margin-bottom: 32px;">
        <h3 style="margin: 0 0 16px 0; color: #1e293b;">üí∞ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</h3>
        <div style="display: flex; align-items: center; gap: 16px;">
            <label for="investmentAmount" style="font-weight: 500; color: #334155;">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ (‡∏ö‡∏≤‡∏ó):</label>
            <input type="number" 
                   id="investmentAmount" 
                   placeholder="0" 
                   min="0"
                   style="padding: 12px 16px; border: 2px solid #cbd5e1; border-radius: 8px; font-size: 1rem; width: 200px;">
            <button type="button" 
                    class="btn btn-primary" 
                    onclick="calculateSROI()"
                    style="padding: 12px 32px;">
                üßÆ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SROI
            </button>
        </div>
        <small style="color: #64748b; display: block; margin-top: 8px;">
            ‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô SROI
        </small>
    </div>

    <!-- Results Cards -->
    <div id="resultsSection" style="display: none;">
        <h3 style="margin-bottom: 24px;">üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå SROI</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 32px;">
            <!-- SROI Ratio Card -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 24px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 8px;">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á SROI</div>
                <div id="sroiRatio" style="font-size: 2.5rem; font-weight: bold;">0.00 : 1</div>
                <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 8px;">
                    ‡∏ó‡∏∏‡∏Å 1 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∏‡∏ô ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°
                </div>
            </div>

            <!-- Investment Card -->
            <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 24px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 8px;">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</div>
                <div id="investmentDisplay" style="font-size: 2rem; font-weight: bold;">‡∏ø0</div>
                <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 8px;">
                    ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
                </div>
            </div>

            <!-- Net Impact Card -->
            <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 24px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 8px;">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (NPV)</div>
                <div id="totalNPV" style="font-size: 2rem; font-weight: bold;">‡∏ø0</div>
                <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 8px;">
                    ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥
                </div>
            </div>

            <!-- Social Value Card -->
            <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); padding: 24px; border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 8px;">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</div>
                <div id="netSocialValue" style="font-size: 2rem; font-weight: bold;">‡∏ø0</div>
                <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 8px;">
                    NPV - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô
                </div>
            </div>
        </div>

        <!-- Chart Section -->
        <div style="background: white; padding: 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 32px;">
            <h3 style="margin-bottom: 20px;">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h3>
            <canvas id="sroiChart" style="max-height: 300px;"></canvas>
        </div>

        <!-- Summary Table -->
        <div style="background: white; padding: 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <h3 style="margin-bottom: 20px;">üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h3>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f1f5f9;">
                            <th style="padding: 12px; text-align: left; border-bottom: 2px solid #cbd5e1;">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</th>
                            <th style="padding: 12px; text-align: left; border-bottom: 2px solid #cbd5e1;">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</th>
                            <th style="padding: 12px; text-align: left; border-bottom: 2px solid #cbd5e1;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #cbd5e1;">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</th>
                            <th style="padding: 12px; text-align: center; border-bottom: 2px solid #cbd5e1;">Deadweight</th>
                            <th style="padding: 12px; text-align: center; border-bottom: 2px solid #cbd5e1;">Attribution</th>
                            <th style="padding: 12px; text-align: center; border-bottom: 2px solid #cbd5e1;">Displacement</th>
                            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #cbd5e1;">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</th>
                            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #cbd5e1;">NPV</th>
                        </tr>
                    </thead>
                    <tbody id="summaryTableBody">
                        <tr>
                            <td colspan="9" style="text-align: center; padding: 40px; color: #94a3b8;">
                                ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SROI"
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div style="margin-top: 32px; display: flex; gap: 16px;">
        <button type="button" class="btn btn-secondary" onclick="previousStep()">
            ‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
        </button>
        <button type="button" class="btn btn-success" onclick="nextStep()">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‚Üí
        </button>
        <button type="button" class="btn" style="background: #10b981; color: white; margin-left: auto;" onclick="generatePDF()">
            üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
        </button>
    </div>
</div>

<!-- Chart.js Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

                        <!-- Step 6: Generate Report -->
                        <div id="step6" class="step-content">
                            <div class="step-header">
                                <h2 class="step-title">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 6: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
                                <p class="step-description">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô SROI ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</p>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢</h3>
                                <ul style="line-height: 2;">
                                    <li>1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</li>
                                    <li>2. ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</li>
                                    <li>3. ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö (Impact Map)</li>
                                    <li>4. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤</li>
                                    <li>5. ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SROI</li>
                                    <li>6. ‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ü‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</li>
                                    <li>7. ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</li>
                                </ul>
                            </div>
                            
                            <div class="section" style="text-align: center;">
                                <button type="button" class="btn btn-success" onclick="generatePDF()" style="font-size: 1.2rem; padding: var(--space-lg) var(--space-2xl);">
                                    üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF
                                </button>
                                <p style="margin-top: var(--space-md); color: var(--color-text-light);">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå PDF</p>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="action-buttons">
                            <button type="button" class="btn btn-secondary" onclick="previousStep()" id="prevBtn">‚Üê ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                            <button type="button" class="btn btn-primary" onclick="nextStep()" id="nextBtn">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK - Initialize FIRST -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
      import { getAuth } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
      
      const firebaseConfig = {
        apiKey: "AIzaSyC-r39KHKkmOZW5xjmNRiKrmPnSWeC9Xrg",
        authDomain: "sroi-bu.firebaseapp.com",
        projectId: "sroi-bu",
        storageBucket: "sroi-bu.firebasestorage.app",
        messagingSenderId: "467289509127",
        appId: "1:467289509127:web:afc1a93643cbddce0849a2"
      };
      
      // Initialize Firebase and make globally available
      window.firebaseApp = initializeApp(firebaseConfig);
      window.auth = getAuth(window.firebaseApp);
      
      console.log('‚úÖ Firebase initialized successfully');
      
      // Dispatch event to let app.js know Firebase is ready
      window.dispatchEvent(new Event('firebaseReady'));
    </script>
    
    <!-- Main App Script - Load AFTER Firebase -->
    <script src="app.js"></script>
<!-- Modal: Add Stakeholder -->
<div id="stakeholderModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢</h2>
            <button class="close-modal" onclick="closeModal('stakeholderModal')">&times;</button>
        </div>
        <div class="modal-body">
            <form id="stakeholderForm">
                <div class="modal-form-group">
                    <label for="stakeholderName">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏° <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="stakeholderName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏î‡πá‡∏Å‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, ‡∏Ñ‡∏£‡∏π, ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô, ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á">
                </div>
                
                <div class="modal-form-group">
                    <label for="stakeholderCount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô <span style="color: #ef4444;">*</span></label>
                    <input type="number" id="stakeholderCount" required min="1" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100">
                    <small>‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</small>
                </div>
                
                <div class="modal-form-group">
                    <label for="stakeholderType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó <span style="color: #ef4444;">*</span></label>
                    <select id="stakeholderType" required>
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
                        <option value="‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á</option>
                        <option value="‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏≠‡πâ‡∏≠‡∏°">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏≠‡πâ‡∏≠‡∏°</option>
                        <option value="‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°</option>
                        <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê</option>
                        <option value="‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏†‡∏≤‡∏Ñ‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô">‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏†‡∏≤‡∏Ñ‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                </div>
                
                <div class="modal-form-group">
                    <label for="stakeholderDescription">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                    <textarea id="stakeholderDescription" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ... (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"></textarea>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('stakeholderModal')">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button type="button" class="btn btn-success" onclick="saveStakeholder()">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
    </div>
</div>

<!-- Modal: Add Outcome -->
<div id="outcomeModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h2>
            <button class="close-modal" onclick="closeModal('outcomeModal')">&times;</button>
        </div>
        <div class="modal-body">
            <form id="outcomeForm">
                <div class="modal-form-group">
                    <label for="outcomeStakeholder">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢ <span style="color: #ef4444;">*</span></label>
                    <select id="outcomeStakeholder" required>
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå --</option>
                    </select>
                    <small>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ô‡∏µ‡πâ</small>
                </div>
                
                <div class="modal-form-group">
                    <label for="outcomeName">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="outcomeName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô, ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô">
                    <small>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</small>
                </div>
                
                <div class="modal-form-group">
                    <label for="outcomeType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö <span style="color: #ef4444;">*</span></label>
                    <select id="outcomeType" required>
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
                        <option value="‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å">‚úÖ ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å</option>
                        <option value="‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö">‚ö†Ô∏è ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö</option>
                    </select>
                </div>
                
                <div class="modal-form-group">
                    <label for="outcomeIndicator">‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="outcomeIndicator" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô 20%, ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô 5,000 ‡∏ö‡∏≤‡∏ó">
                    <small>‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ô‡∏µ‡πâ (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå)</small>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('outcomeModal')">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button type="button" class="btn btn-success" onclick="saveOutcome()">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
    </div>
</div>    
</body>
</html>
